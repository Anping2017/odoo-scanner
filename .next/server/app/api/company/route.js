"use strict";(()=>{var e={};e.id=777,e.ids=[777],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4992:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>v,patchFetch:()=>y,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var r={};o.r(r),o.d(r,{GET:()=>d});var a=o(9303),n=o(8716),s=o(670),i=o(7070),c=o(4405);async function p(e,t,o,r){let a=await fetch(`${e}${t}`,{method:"POST",headers:{"Content-Type":"application/json",cookie:r},body:JSON.stringify({jsonrpc:"2.0",id:Date.now(),method:"call",params:o}),cache:"no-store"});return await a.json().catch(()=>({}))}async function d(e){try{let t=e.cookies,o=e.headers.get("x-forwarded-host")||e.headers.get("host")||void 0,r=(0,c.jm)(o),a=t.get("od_base")?.value||r?.url,n=t.get("od_db")?.value||r?.db,s=t.get("od_session")?.value;if(!a||!n||!s)return i.NextResponse.json({error:"未登录"},{status:401});let d=`session_id=${s}`,u=await p(a,"/web/dataset/call_kw",{model:"res.company",method:"search_read",args:[[],["id","name"]],kwargs:{limit:200}},d),l=u?.result||[];return i.NextResponse.json({companies:l})}catch(e){return i.NextResponse.json({error:e?.message||"加载公司失败"},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/company/route",pathname:"/api/company",filename:"route",bundlePath:"app/api/company/route"},resolvedPagePath:"C:\\working\\next.js\\odoo-inventory-scanner\\app\\api\\company\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:h,serverHooks:m}=u,v="/api/company/route";function y(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},4405:(e,t,o)=>{o.d(t,{jm:()=>n});let r={"moboplus.co.nz":{url:"https://moboplus.co.nz",db:"odoo",defaultLocationId:1},"repair.raytech.co.nz":{url:"https://repair.raytech.co.nz",db:"db-raytech-repair",defaultLocationId:1}},a=process.env.ODOO_URL&&process.env.ODOO_DB?{url:process.env.ODOO_URL,db:process.env.ODOO_DB,defaultLocationId:Number(process.env.ODOO_LOCATION_ID||0)||void 0}:void 0;function n(e){let t=(e||"").toLowerCase().replace(/^www\./,"").split(":")[0];return t.endsWith("moboplus.co.nz")?r["moboplus.co.nz"]:t.endsWith("repair.raytech.co.nz")||"raytech.co.nz"===t?r["repair.raytech.co.nz"]:a}}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[276,972],()=>o(4992));module.exports=r})();